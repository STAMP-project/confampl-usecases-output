# Proactive CAMP sample

In the context of the project STAMP, ActiveEon is a use case to explore several configuration notably for using different databases. This readme explain show how to run camp for proactive worflows & schedulling.

## Generate configurations

If you have already a camp docker image installed, you can proceed to use camp with this use case. Go to `confampl-usecases-output/activeeon/CAMP Configuration` and then run:

```bash
docker run -t -v $PWD:/campworkingdir camp camp generate -d /campworkingdir
```

CAMP then generates new Dockerfiles, properly chained together according to the
configurations generated by camp generate. To do so, you can apply the following
 command:

```bash
docker run -t -v $PWD:/campworkingdir camp camp realize -d /campworkingdir
```

You can clean exited container and unlinked images using:

```bash
docker system prune
```

## Running configurations

Now that the configurations are generated, you need to do some modifications
to make it work:

* You need to provide your host machine address to configure the
 proactive server on docker. e.g., on mac or linux you can use `ifconfig`.

* To get snapshot version of proactive from jenkins, you need to provide the
username and api-token first. ([please contact us to get one](mailto:fabien.viale@activeeon.com))

* Now edit the scripts `get-last-proactive-do-not-commit.sh` and replace
USERNAME and TOKEN by your credentials.

* Finally to start the proactive server with different DBs, go to the config folder generated
by camp, `cd out/config_1` and `cd out/config_2` and run `docker-compose up`
to start both containers (proactive + database.)

## Run system-tests

* Now it is time to run some system-tests over generated configs.

* The scheduling-system-tests project is a private repo on bitbucket. Access to the repo has to be requested ([please contact us](mailto:fabien.viale@activeeon.com))

-Clone the project
```bash
git clone https://bitbucket.org/activeeon/scheduling-system-tests/src/master/
```
-Run tests
```bash
./gradlew clean -Plocal test
```
